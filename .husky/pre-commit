#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run CSS import validation
echo "ğŸ” Validating CSS imports..."
node scripts/validate-css-imports.js
if [ $? -ne 0 ]; then
  echo "âŒ CSS import validation failed!"
  echo "Please fix the issues before committing."
  exit 1
fi

# Run CSS class checking
echo "ğŸ” Checking CSS class dependencies..."
node scripts/check-css-classes.js
if [ $? -ne 0 ]; then
  echo "âŒ CSS class check failed!"
  echo "Critical CSS classes are missing or have changed."
  exit 1
fi

# Run stylelint on CSS files
echo "ğŸ¨ Linting CSS files..."
npx stylelint "styles/**/*.css" --fix
if [ $? -ne 0 ]; then
  echo "âŒ CSS linting failed!"
  echo "Please fix the CSS issues before committing."
  exit 1
fi

# Run syntax validation
echo "âœ¨ Validating JavaScript syntax..."
npm run test:syntax
if [ $? -ne 0 ]; then
  echo "âŒ JavaScript syntax validation failed!"
  exit 1
fi

echo "âœ… All pre-commit checks passed!"
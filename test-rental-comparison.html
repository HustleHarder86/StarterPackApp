<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test RentalComparisonView Component</title>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100">
  <div class="container mx-auto p-8">
    <h1 class="text-2xl font-bold mb-4">RentalComparisonView Component Test</h1>
    
    <div id="component-container" class="mb-8"></div>
    
    <button onclick="loadAndTestComponent()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
      Load and Test Component
    </button>
    
    <div id="status" class="mt-4 p-4 bg-gray-200 rounded"></div>
  </div>

  <script>
    function updateStatus(message, isError = false) {
      const status = document.getElementById('status');
      status.innerHTML += `<div class="${isError ? 'text-red-600' : 'text-green-600'}">${new Date().toLocaleTimeString()}: ${message}</div>`;
    }

    function loadAndTestComponent() {
      updateStatus('Starting component test...');
      
      // Sample test data
      const testData = {
        longTermRental: {
          monthlyRent: 3000,
          rentRange: { low: 2800, high: 3200 },
          vacancyRate: 5,
          annualRevenue: 34200,
          annualExpenses: 8000,
          annualProfit: 26200,
          cashFlow: 2183,
          capRate: 3.1,
          comparables: [
            { description: "3 bed 2 bath house on Main St - $2900/month" },
            { description: "Similar property on Oak Ave - $3100/month" },
            { description: "Comparable home nearby - $3000/month" }
          ]
        },
        strAnalysis: {
          avgNightlyRate: 150,
          occupancyRate: 65,
          annualRevenue: 35588,
          annualExpenses: 10000,
          annualProfit: 25588
        },
        comparison: {
          betterStrategy: 'ltr',
          monthlyIncomeDiff: -33,
          annualIncomeDiff: -612,
          annualProfitDiff: -612,
          breakEvenOccupancy: 67,
          percentageIncrease: -2.3,
          recommendation: "Long-term rental is recommended due to more stable income and lower management overhead.",
          riskAssessment: "STR income is slightly lower and requires more active management. Consider LTR for passive income."
        },
        propertyDetails: {
          estimatedValue: 850000
        }
      };

      const container = document.getElementById('component-container');
      
      // Check if React is loaded
      if (!window.React || !window.ReactDOM) {
        updateStatus('React or ReactDOM not loaded!', true);
        return;
      }
      updateStatus('React loaded successfully');

      // Check if Babel is loaded
      if (!window.Babel) {
        updateStatus('Babel not loaded!', true);
        return;
      }
      updateStatus('Babel loaded successfully');

      // Load the component
      const script = document.createElement('script');
      script.type = 'text/babel';
      script.src = '/components/RentalComparisonView.jsx';
      
      script.onload = () => {
        updateStatus('Component script loaded');
        
        // Give Babel time to process
        setTimeout(() => {
          if (window.RentalComparisonView) {
            updateStatus('Component available on window');
            
            try {
              // Mount the component
              ReactDOM.render(
                React.createElement(window.RentalComparisonView, {
                  analysis: testData,
                  propertyAddress: "123 Test Street, Test City"
                }),
                container
              );
              updateStatus('Component mounted successfully!');
            } catch (error) {
              updateStatus(`Error mounting component: ${error.message}`, true);
              console.error(error);
            }
          } else {
            updateStatus('Component not available on window after loading', true);
            
            // Try to check if it's in a different location
            updateStatus('Checking window object...');
            console.log('Window contents:', Object.keys(window).filter(k => k.includes('Rental')));
          }
        }, 1000);
      };
      
      script.onerror = (error) => {
        updateStatus(`Error loading component script: ${error}`, true);
      };
      
      document.body.appendChild(script);
    }
  </script>
</body>
</html>